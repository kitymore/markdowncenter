---
id: shiliangditu
title: 矢量地图
---

本章介绍矢量地图的管理过程，包括创建、存在和销毁。

创建地图对象

首先，准备一个HTML容器，设置好宽和高。


```html
<div id="map"></div>
```

其次，全局参数设置，CfMap支持本地部署。

CfMap支持本地部署，在地图应用开发需要支持本地环境时，需要设置一下全局参数，否则CfMap相应的数据及服务将访问CfMap线上服务。


最后，构造一个Map对象。

```js
var map = new CfMap.Map({
    container: "map",
    style: "cfmap://maps/x/base/", /*底图样式*/
    center: [116.46,39.92], /*地图中心点*/
    zoom: 10,   /*地图默认缩放等级*/
    pitch: 0,   /*地图俯仰角度*/
    maxZoom:17, /*地图最大缩放等级*/
    minZoom:3  /*地图最小缩放等级*/
});
```

地图加载完成

创建地图对象后，开始加载地图资源，地图资源加载完成后触发load事件。


```js
map.on('load', function(){
    // 地图资源加载完成后触发
    // 增加自定义数据源、自定义图层
});
```

销毁地图对象

调用remove方法来销毁地图，该方法执行后，地图对象被注销，内存释放，地图容器被清空。


```js
// 销毁地图，并清空地图容器
map.remove( );
```

### 地图状态

地图状态包括地图中心点、缩放级别、倾斜角度、旋转角度等内容。本章介绍地图状态的常用方法以及根据几何边界调整视野范围方法。

设置 / 获取地图中心点和缩放级别

设置、获取地图中心点：

---

```js
var position = CfMap.LngLat(116.46,39.92);   // 对象形式
// var position = [116.46,39.92]; // 数组形式
map.setCenter(position); 
// 获取地图中心点
var center = map.getCenter(); 
```

设置、获取地图缩放级别：


```js
// 设置地图缩放级别，值为整数或小数，值域范围为[0,20]。
map.setZoom(12); 
// 获取地图缩放级别
var zoom = map.getZoom(); 
```

同时设置地图中心点和缩放级别：


```js
// 同时传入缩放级别和中心点经纬度
map.setZoomAndCenter(12, [116.46,39.92]);
```

设置地图整级缩放或非整级缩放：

```js
// 设置地图整级缩放
map.scrollZoom.setWheelZoomRate(1); //设置鼠标滚轮滚动一下的缩放比例
map.scrollZoom.setZoomRate(1); //设置触摸屏的缩放比例，最大值为1
// 设置地图非整级缩放
map.scrollZoom.setWheelZoomRate(1 / 600); //速率值越小，地图的缩放越细腻
```

设置 / 获取地图旋转角度和倾斜角度

设置、获取地图旋转角度：



```js
// 设置地图旋转角度，值为整数或小数，值域范围为[0,360]。
map.setBearing(90); 
// 返回沿正北方向逆时针的旋转角度
var bearing = map.getBearing(); 
```

设置、获取地图倾斜角度：



```js
// 设置地图倾斜角度，值为整数或小数，值域范围为[0,60]。
map.setPitch(12); 
// 获取地图倾斜角度
var pitch = map.getPitch(); 
```

根据几何边界调整视野范围

在地图上覆盖物较多的情况下，如果需要保证所有覆盖物都在视野范围内，那么需要将地图调整到合适的缩放等级和中心点，我们可以先计算覆盖物的所有形状点中的最小和最大的经度和纬度值，以此构造几何边界，并调用fitBounds() 方法，实现视野范围自动适配的效果。


```js
var sw = [116.46,39.92];//所有几何形状点中最小的经度和纬度值
var ne = [116.47,39.94];//所有几何形状点中最大的经度和纬度值

map.fitBounds([sw,ne]);//地图匹配边界框视野范围
```
